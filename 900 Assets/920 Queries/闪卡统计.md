---
obsidianUIMode: preview
cssclasses:
  - fullwidth
type: query
---

## è¯´æ˜

é—ªå¡æ ¼å¼ï¼š
- å¡«ç©ºé—ªå¡ï¼š ==é«˜äº®æ–‡æœ¬==
- å•è¡Œé—ªå¡ï¼š `;;` ç¿»è½¬å¡ç‰‡ `;;;`
- å¤šè¡Œé—ªå¡ï¼š `?` ç¿»è½¬å¡ç‰‡ `??`

æŸ¥æ‰¾è·¯å¾„ï¼š `600 Zettelkasten` `300 Resources/330 Books`

---

## é—ªå¡ç¬”è®°åˆ—è¡¨åŠç»Ÿè®¡æ•°æ®
```dataviewjs
// å®šä¹‰è¦æŸ¥è¯¢çš„è·¯å¾„
let targetPaths = ['"600 Zettelkasten"', '"300 Resources/330 Books"'];

// å¿«é€Ÿæ£€æµ‹é—ªå¡ç±»å‹å’Œæ•°é‡
function detectFlashcards(content) {
    let cardCounts = {
        highlight: 0,
        singleLine: 0,
        multiLine: 0
    };
    
    // æ£€æµ‹å¡«ç©ºé—ªå¡
    let highlightMatches = content.match(/==.+?==/g);
    if (highlightMatches) {
        cardCounts.highlight = highlightMatches.length;
    }
    
    // æ£€æµ‹å•è¡Œé—ªå¡
    let lines = content.split('\n');
    lines.forEach(line => {
        if (line.includes(';;')) {
            cardCounts.singleLine++;
        }
    });
    
    // æ£€æµ‹å¤šè¡Œé—ªå¡
    lines.forEach(line => {
        let trimmed = line.trim();
        if (trimmed === '?' || trimmed === '??') {
            cardCounts.multiLine++;
        }
    });
    
    return cardCounts;
}

let grouped = {};
let totalStats = {
    files: 0,
    highlight: 0,
    singleLine: 0,
    multiLine: 0
};

// éå†æ¯ä¸ªç›®æ ‡è·¯å¾„
for (let path of targetPaths) {
    let pages = dv.pages(path);
    
    for (let page of pages) {
        let content = await dv.io.load(page.file.path);
        if (content) {
            let cardCounts = detectFlashcards(content);
            let totalCards = cardCounts.highlight + cardCounts.singleLine + cardCounts.multiLine;
            
            // å¦‚æœæ‰¾åˆ°é—ªå¡ï¼Œæ·»åŠ åˆ°ç»“æœä¸­
            if (totalCards > 0) {
                let folder = page.file.folder || "æ ¹ç›®å½•";
                if (!grouped[folder]) {
                    grouped[folder] = [];
                }
                
                let cardTypes = [];
                if (cardCounts.highlight > 0) cardTypes.push(`å¡«ç©ºé—ªå¡(${cardCounts.highlight})`);
                if (cardCounts.singleLine > 0) cardTypes.push(`å•è¡Œé—ªå¡(${cardCounts.singleLine})`);
                if (cardCounts.multiLine > 0) cardTypes.push(`å¤šè¡Œé—ªå¡(${cardCounts.multiLine})`);
                
                grouped[folder].push({
                    link: page.file.link,
                    totalCards: totalCards,
                    cardTypes: cardTypes,
                    counts: cardCounts
                });
                
                // æ›´æ–°æ€»ç»Ÿè®¡
                totalStats.files++;
                totalStats.highlight += cardCounts.highlight;
                totalStats.singleLine += cardCounts.singleLine;
                totalStats.multiLine += cardCounts.multiLine;
            }
        }
    }
}

// æŒ‰æ–‡ä»¶å¤¹æ˜¾ç¤ºç»“æœ
for (let folder in grouped) {
    dv.header(3, `ğŸ“ ${folder}`);
    
    // åˆ›å»ºåŒ…å«ç»Ÿè®¡ä¿¡æ¯çš„åˆ—è¡¨
    let listItems = grouped[folder].map(item => 
        `${item.link} - ${item.cardTypes.join(", ")} (å…±${item.totalCards}å¼ )`
    );
    
    dv.list(listItems);
    
    // æ˜¾ç¤ºæ–‡ä»¶å¤¹ç»Ÿè®¡
    let folderStats = grouped[folder].reduce((acc, item) => {
        acc.files++;
        acc.highlight += item.counts.highlight;
        acc.singleLine += item.counts.singleLine;
        acc.multiLine += item.counts.multiLine;
        return acc;
    }, { files: 0, highlight: 0, singleLine: 0, multiLine: 0 });
    
    let folderTotal = folderStats.highlight + folderStats.singleLine + folderStats.multiLine;
    dv.paragraph(`ğŸ“Š **${folder}**: ${folderStats.files} ä¸ªæ–‡ä»¶ï¼Œå…± ${folderTotal} å¼ é—ªå¡`);
    dv.paragraph("");
}

// æ˜¾ç¤ºæ€»ä½“ç»Ÿè®¡ä¿¡æ¯
if (Object.keys(grouped).length === 0) {
    dv.paragraph("âŒ æœªæ‰¾åˆ°åŒ…å«é—ªå¡æ ¼å¼çš„ç¬”è®°ã€‚");
} else {
    let grandTotal = totalStats.highlight + totalStats.singleLine + totalStats.multiLine;
    
    dv.header(3, "ğŸ“ˆ æ€»ä½“ç»Ÿè®¡");
    dv.paragraph(`ğŸ—‚ï¸ **æ€»æ–‡ä»¶æ•°**: ${totalStats.files} ä¸ª`);
    dv.paragraph(`ğŸ“š **æ€»é—ªå¡æ•°**: ${grandTotal} å¼ `);
    
    if (totalStats.highlight > 0) {
        dv.paragraph(`ã€€ã€€â€¢ å¡«ç©ºé—ªå¡: ${totalStats.highlight} å¼ `);
    }
    if (totalStats.singleLine > 0) {
        dv.paragraph(`ã€€ã€€â€¢ å•è¡Œé—ªå¡: ${totalStats.singleLine} å¼ `);
    }
    if (totalStats.multiLine > 0) {
        dv.paragraph(`ã€€ã€€â€¢ å¤šè¡Œé—ªå¡: ${totalStats.multiLine} å¼ `);
    }
    
    // è®¡ç®—å¹³å‡å€¼
    let avgCards = (grandTotal / totalStats.files).toFixed(1);
    dv.paragraph(`ğŸ“Š **å¹³å‡æ¯ä¸ªæ–‡ä»¶**: ${avgCards} å¼ é—ªå¡`);
}
```



