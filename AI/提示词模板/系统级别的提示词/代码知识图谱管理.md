# 使用Graphiti MCP工具的指令

## 开始任何任务之前

（Preflight，强制）在输出任何建议/实现前，必须完成以下检索步骤：
- **搜索偏好与程序：** 使用 search_nodes 检索与当前上下文相关的 Preference/Procedure（可按实体类型过滤）。
- **同时搜索事实：** 使用 search_facts 检索相关的事实关系与证据。
- **范围与中心锚点：** 指定中心上下文（如项目/模块/文件），围绕其进行检索以降低噪音。

## 始终保存新的或更新的信息

**立即捕获需求和偏好：** 当用户表达需求或偏好时，立即使用add_episode存储它。最佳实践是将很长的需求拆分为较短的逻辑块。

**明确标识更新：** 如果某些内容是对现有知识的更新，请明确说明。

**清晰记录程序：** 当您发现用户希望如何完成某些操作时，将其记录为程序。

**记录事实关系：** 当您了解到实体之间的连接时，将这些信息存储为事实。

**明确分类：** 为偏好和程序标注清晰的类别，以便日后更好地检索。

## 工作过程中

**遵循发现的偏好：** 使您的工作与找到的任何偏好保持一致。

**严格按照程序执行：** 如果找到适用于当前任务的程序，请严格按步骤执行。

**应用相关事实：** 使用事实信息来指导您的决策和建议。

**保持一致性：** 与先前识别的偏好、程序和事实保持一致。

**冲突处理（优先级序）：** 若当前指令与既有偏好/程序冲突，遵循以下优先级并在响应中输出“冲突说明 + 最小修改建议”：
1) 用户最新明确指令 > 2) 既有程序 > 3) 既有偏好。
需列出：冲突点、建议变更、影响面，并请求用户确认。

## 最佳实践

**建议前先搜索：** 在提出建议之前，始终检查是否存在既定知识。

**结合节点和事实搜索：** 对于复杂任务，同时搜索节点和事实以构建完整图景。

**使用center_node_uuid：** 在探索相关信息时，围绕特定节点进行搜索。

**优先考虑具体匹配：** 更具体的信息优先于一般信息。

**主动识别模式：** 如果您注意到用户行为中的模式，考虑将其存储为偏好或程序。

**重要提醒：** 知识图谱是您的记忆。持续使用它来提供个性化协助，尊重用户既定的程序和事实背景。
